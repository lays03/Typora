异构双信道飞行自组网路由协议研究与实现

## 1. 贡献

1. **基于OLSR 路由协议，提出了一种无中心节点的异构双信道路由协议DC-OLSR。**

  该协议保留OLSR 的HELLO 消息和MPR 机制，对拓扑信息发送环节进行改进，使用通信跳数少的控制信道传输数据信道上的拓扑信息，从而提高了路由的收敛速度。与此同时，DC-OLSR 针对不同优先级的数据，采取不同的信道转发策略，在保证吞吐率的同时，提高了网络的可靠性。

2. **借鉴HWMP 树路由机制和DSR 源路由转发过程，提出了一种有中心节点的异构双信道路由协议DCTR。**

  该协议在控制信道上建立一棵以中心节点为根的先应路由树，普通节点将感知到的链路信息通过路由树汇聚到根节点。普通节点通信所需路由由中心节点计算后下发，而获得路由前，节点传输的数据包由中心节点代为转发，减少了普通节点维护路由的开销。DCTR 为不同优先级的数据设置不同的转发策略，保证吞吐率的同时，提高了网络的可靠性。

## 2. 绪论

异构双信道飞行自组网在硬件设备上与传统飞行自组网的区别在于节点的无线接口配置

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221121091511714.png" alt="image-20221121091511714" style="zoom: 50%;" />



**<mark>数据信道：工作在高频段（如2.4GHz），传输速率较高，但通信距离较近，主要用于传输大容量数据</mark>**

**<mark>控制信道：工作在低频段（如 430MHz），传输速率较低，但可靠性高，且传输距离较远，主要用于传输控制信息和重要数据</mark>**

两个信道的协同配合，使得网络**在链路质量较好时具有较强的数据传输能力**，而**在数据信道链路质量恶化时虽然损失了部分通信能力，但控制信道保证了关键指令和重要数据的正常传输，大大提高了网络的鲁棒性，适用于对网络可靠性有较高要求的应用场景**

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221121092923690.png" alt="image-20221121092923690" style="zoom:50%;" />

<mark>**异构双信道自组网的路由问题：**</mark>

（1）如何协调利用两个异构信道进行路由的发现和维护

通信范围的差异，因此在不同信道上通信的跳数不同，路径也不同。在不同信道上感知到的邻居和链路信息也不同

**协议应考虑不同信道间链路信息的融合，以及跨信道的路由计算问题**

（2）节点间通信时，如何对不同类型数据有区别地进行路由

每种数据的重要程度不同，对网络可靠性的影响也不相同

**协议应考虑为不同类型的数据选择合理的路由策略，保证重要数据可靠传输。**

（3）链路中断时，路由协议如何维护网络的连通性

数据信道断开的话，路由协议将数据包转移到控制信道进行路由

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221121094112379.png" alt="image-20221121094112379" style="zoom:50%;" />



### 2.1 多接口多信道自组网路由协议

#### 2.1.1 同构多接口多信道路由协议

每个节点配备多个同构的无线接口，通过协调数据在多个接口上传输，可显著降低网络的竞争冲突并提高网络的吞吐率。

**09年的：**文献[56](支持多接口的 AODV 路由协议[J]. 计算机工程, 2009)提出了一种支持多接口的AODV 路由协议，通过为每个节点配置多个网络接口，根据业务数据流进行传输分配。仿真结果显示，在一定范围内增加网络接口数量时，多接口AODV 路由协议能够显著提高网络的吞吐量。

**06年的：**文献[58]在DSR 的基础上提出了一种基于双信道的路由协议DCR。在该协议中，网络节点间存在两个独立的信道A 和B，协议利用信道A 获取全网节点的状态信息（包括位置、速度等），信道B 利用信道A 获取的全局节点信息计算构造路由，并进行数据传输。仿真结果表明，DCR 在分组投递率、平均端到端延迟和归一化路由开销上均较DSR 和DCBR 取得了更好的表现。然而，DCR 通过一个信道进行状态收集，一个信道计算路由的信息共享方式仅适用于同构双接口网络，在异构双信道条件下则无法使用。

#### 2.1.2 异构多接口多信道路由协议

<mark>Dual-channel-based mobile ad hoc network routing
technique for indoor disaster environment[J]. IEEE Access, 2020</mark>

室内火灾救援的场景
为由配备两个异构接口的节点组成的网络设计了一种异构双信道路由协议DCR。网络中的两个异构接口分别工作在不同的频段，**其中一个工作在常规的2.4GHz 频段（数据信道），另一个则工作在相对低的频段（控制信道），因而具有较远的传输距离。**

协议运行时，节点通过高频接口交换邻居信息，接着通过低频接口快速将局部拓扑信息广播到其余节点，收到其他
节点的拓扑信息后，节点可快速计算出到达全网任意节点的路由。仿真结果表明，DCR 在包递交率和平均端到端延迟方面较改进的OLSR 和DSR 均取得了较好的表现，尤其是在路由建立速度方面更为明显。然而，该协议中，**<font color=red>低频信道仅用于单跳通信，并且只发挥了收集拓扑信息的辅助作用，因而使得协议的适用范围受到了较大限制。</font>**



## 3. 无中心节点的异构双信道路由协议DC-OLSR

飞行自组网从移动自组网继承了诸多的路由协议，研究人员在这些基础协议之上，结合飞行自组网的特点，同时考虑了**移动模型、能耗模型、应用模型**等因素，改进设计了各种飞行自组网路由协议。这些协议中尚无一种通用普通的路由协议，不同的路由协议都适用于不同的飞行自组网模型。因此谈论飞行自组网路由协议设计，不能脱离特定的网络模型

### 3.1 网络模型

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221121183809354.png" alt="image-20221121183809354" style="zoom: 33%;" />

**每个节点配备两个无线接口**，一个接口工作在较高频段（如2.4GHz），采用高阶调制（如OFDM），传输速率高，但通信距离近，且抗干扰能力一般，接口的物理层可采用802.11 协议作为多址接入方式，该接口称为数据接口，其工作的信道称为数据信道

另一个接口工作在较低频段（如340MHz），采用低阶调制，传输速率低，但通信距离远，可数倍于数据接口，同时误码率低，可靠性高，该接口称为控制接口，其工作的信道称为控制信道

较高优先级的数据：起到协调整个网络正常运行的指挥控制类数据，以及目标预警等关键数据，必须尽力确保其可靠传输。

较低优先级的数据：图像视频、地形测绘等业务产生的数据对可靠性要求相对较低，但其容量普遍较大，因而需要保证较高的传输速率。



### 3.2 路由问题分析

#### 3.2.1 现有路由协议的局限性

- <mark>**不同信道的接口是不能相互使用的，意思就是通过长短接口的路由拓扑图是不一样的**</mark>
- 路由层面<mark>**数据的优先级**</mark>没有考虑

#### 3.2.2 基础路由选择

ADOV和DSR利用双信道进行路由发现比较困难<mark>**<font color=red>（思考一下是否真的没有办法考虑双信道？）</font>**</mark>

OLSR 和DSDV 作为表驱式路由，通过周期性交换节点拓扑消息，时刻维持一张全局的路由表。在这些消息的传播扩散过程中，我们可以利用异构双信道执行一些优化**<mark>（二者有什么区别？）</mark>**



### 3.3 DC-OLSR（Dual-Channel OLSR） 协议设计

普遍存在的问题：异构双信道网络中控制信道传输距离远，消息将通过控制信道率先到达，因而将先在控制信道建立路由，而之后即使为数据信道也增加路由项，也将因为实际距离超出通信范围而使路由无效

<mark>**对OLSR的修改：**</mark>

两个信道各自通过HELLO 消息进行链路感知和邻居发现，**控制信道通过MPR机制周期性广播TC 消息，但数据信道不再通过MPR 机制向外广播TC 消息**，节点数据信道的TC 消息将在控制信道代为传输，以此提高数据信道路由收敛速度，使得在拓扑频繁变化时数据信道能保持较好的传输性能，以及对链路失效做出更快的反应。

<font color=red>**（因为控制信道传输距离远，因此通过控制信道进行广播TC消息，能更快的完成拓扑信息的更新？）**</font>

#### 3.3.1 路由构建流程

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123092021519.png" alt="image-20221123092021519" style="zoom:50%;" />

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123092104327.png" alt="image-20221123092104327" style="zoom:33%;" />

#### 3.3.2 数据转发流程

根据数据的优先级为数据包选择不同的信道，优先级通过传输层的五元组进行映射

0 代表高优先级，1 代表中优先级，2 代表低优先级

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123092641708.png" alt="image-20221123092641708" style="zoom:50%;" />

节点过往数据包根据五元组从表中匹配得到相应的优先级，其中含*号条目在内存中重排序后置于含有明确值的条目之后，匹配到优先级后将五元组与优先级关系条目进行缓存，之后的数据包只需匹配缓存即可确定优先级<mark>**（意思是不是以后只需要查看源端口号和目的端口号，即可确定该数据包的优先级？）**</mark>，缓存应设置合理的生存时间以便及时清除无效缓存。

路由协议根据数据包优先级为其选择相应的信道进行传输，具体可以分为三种情况：

1. **高优先级**业务往往数据量较少但可靠性要求高，因而**仅通过控制信道传输**。数据包从本机发出前，路由协议会在控制信道路由表中寻找路由项，然后从控制信道对应的接口发出。
2. **数据量较大的低优先级业务数据包（I类）**，**只通过数据信道传输**。数据包从本机发出前，路由协议会在数据信道路由表中寻找路由项，然后从数据信道对应的接口发出。
3. **数据量较小的低优先级业务数据包（II类）**，**优先通过数据信道传输，当数据信道不可达时，也通过控制信道为其转发**。数据包从本机发出前，路由协议会在数据信道路由表中寻找路由项，然后从数据信道对应的接口发出。                                   

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123094041308.png" alt="image-20221123094041308"  />



## 4. 有中心节点的异构双信道路由协议DCTR

### 4.1 网络模型

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123101102736.png" alt="image-20221123101102736" style="zoom:33%;" />

有人机拥有较强的计算存储能力和通信质量，同时不考路由能耗开销，无人机计算存储能力和能量均有限

在这样网络中，我们设计路由协议应该最大程度上利用好有人机的资源，减少无人机维护路由的开销，使得
整个网络的生存时间最大化，从而更好地执行任务。

<mark>**<font color=red>这里的有人机，是不是也可以看成是无人机集群的簇头</font>**</mark>

### 4.2 路由问题分析

树形路由：节点在转发数据包但却没有相应路由的时候，可以将数据包通过路由树直接递交到根节点，由根节点先进行转发。接着根节点依靠收集到的全网节点的链路信息为普通节点计算路由并下发。普通节点只在一定时间内缓存使用过的路由，而不再维护全网的路由表，同时普通节点也不主动进行路由发现。对于普通节点而言，源路由转发是一种比较合适的数据包转发方式，因为只需将路由附着在数据包中即可。

DCTR（Dual-Channel Tree based Routing）路由协议将基于树路由和源路由来进行设计，其中树路由参考无线Mesh 网络 802.11s 标准的默认路由协议HWMP 中的树路由，而节点的路由转发过程则借鉴动态源路由DSR 中的源路由转发过程。

### 4.3 DCTR 协议设计

#### 4.3.1 DSR

DSR路由发现

![image-20221123104949311](C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221123104949311.png)



DSR路由维护

路由的维护仅在使用源路由发送或转发数据包时进行。

源节点确认链路可达性的方式：主动式和被动式

被动式：节点在发送或者转发数据包之前会先在本地缓存，直到通过混杂模式收到下一跳也将该数据包发出，以此确认下一跳正确收到该数据包

主动式：在源路由选项之后附带一个ACK请求选项，当节点收到带有这种选项的数据包时，则将向上一跳返回一个ACK 分组，收到ACK 分组的节点则确认下一跳可达，数据包已送达，从而将准备重发的数据包从相应队列中删除。

在上述两种应答均失效时，节点认为其与下一跳之间的链路断开，此时将尝试进行数据包抢救，并向源节点发送包含路由错误选项（RRER）的分组，沿途转发此分组的节点将检查并删除那些包含失效链路的路由缓存。而该条路由的源节点收到路由错误分组后也将删除那些已经失效的路由，并为接下来传输的数据包执行新的路由发现过程。

#### 4.3.2 树路由

既有主动式路由协议的灵活性，又有按需路由的有效性。按需模式采用链路层改进的AODV 协议，当有数据传输需要时执行路由发现。主动模式需要网络中配置根节点，当节点间通信需要路由时，先不执行路由发现，而是直接将数据包发送到根节点，根节点根据建立好的先应树路由将数据包转发至目的节点。

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221124091616082.png" alt="image-20221124091616082" style="zoom:50%;" />

当源节点向目的节点发送数据时，首先检查缓存中是否存在到目的节点的路由，若有则直接按路由转发；否则直接将数据包发送到根节点，根节点将数据打上标记并转发到目的节点，目的节点收到数据包后向源节点发起路由发现，构建双向路由。

#### 4.3.3 DCTR详细设计

##### 4.3.3.1 建立树路由

中心节点（根节点）和普通节点

根节点在**控制信道**周期性广播根节点通告消息（Root Announcement Messages，RANN），把根节点的信息通告给网络中的普通节点。

普通节点收到RANN 消息后，在本地维护一个父节点信息结构体，存储**根节点地址**、**当前节点的父节点地址**（从IP 报头中获知）、**RANN 到达当前节点时的跳数**、**当前节点是否收到过RANN 消息标志**等字段

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221124092507924.png" alt="image-20221124092507924" style="zoom: 33%;" />

经过一段时间后，网络中便形成了一棵以中心节点为根的路由树，但与HWMP中路由树不同，这棵树是单向的，即普通节点可以逐跳到达根节点，但根节点不知道自己的子节点情况

##### 4.3.3.2 拓扑信息收集

节点在**控制信道**和**数据信道**通过HELLO 消息进行链路感知和邻居发现，形成每个节点局部的拓扑信息库。之后普通节点周期性在**控制信道**将**控制信道和数据信道**的拓扑信息通过路由树汇聚到中心节点，中心节点收到拓扑信息后，为控制信道和数据信道分别建立拓扑信息库，以便路由计算时使用

##### 4.3.3.3 数据传输过程

<img src="C:\Users\27252\AppData\Roaming\Typora\typora-user-images\image-20221124102456703.png" alt="image-20221124102456703" style="zoom:50%;" />



## 5. 仿真实验与结果分析

### 5.1 仿真环境

NS-3

节点移动模型为Random waypoint mobility

为什么在2D场景下进行实验？

































